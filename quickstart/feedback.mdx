---
title: 'Providing Feedback'
description: 'Help your router learn and improve automatically'
---

## Understanding Feedback
The system improves through:
<CardGroup cols={2}>
  <Card title="Direct Judgements" icon="star">
    - Immediate quality scoring
    - Guide future routing decisions
    - Help identify optimal models
  </Card>
  <Card title="Request/Response Storage" icon="database">
    - Builds interaction history
    - Provides training data
    - Enables performance analysis
  </Card>
</CardGroup>

## Add feedback
To provide direct judgements, let's create a new file `add_feedback.py`:

```python add_feedback.py
from config import API_URL, ORG_ID, HEADERS
import requests

router_id = input("Enter router ID: ")
version_id = input("Enter version ID: ")
request_response_id = input("Enter request response ID: ")

# Add judgement
url = f'{API_URL}/org/{ORG_ID}/routers/{router_id}/versions/{version_id}/judgement'

data = {
    'request_response_id': request_response_id, 
    'judgement': {
        'score': 3,
        'rationale': 'The translation was accurate and preserved the meaning of the original text.'
    }
}

response = requests.post(url, headers=HEADERS, json=data)
print(response.json())
judgement_id = response.json()['judgement_id']
print(f"Added judgement with ID: {judgement_id}")
```

## Add data
To add data, let's create a new file `add_data.py`:

```python add_data.py
import requests
from config import API_URL, ORG_ID, HEADERS, client

router_id = input("Enter router ID: ")
version_id = input("Enter version ID: ")

request = {
    "model": "gpt-4o-mini-2024-07-18",
    "messages": [
        {"role": "system", "content": """You are a highly skilled translator with expertise in many languages. Your task is to:
            - Identify if the input is Korean or English
            - If Korean, translate to English
            - If English, translate to Korean
            - Preserve meaning, tone, and nuance
            - Maintain proper grammar and formality level
            """},
        {"role": "user", "content": "Tell me a joke?"}
    ],
}

response = client.chat.completions.create(
    model="gpt-4o-mini-2024-07-18",
    messages=[
        {"role": "system", "content": """You are a highly skilled translator with expertise in many languages. Your task is to:
            - Identify if the input is Korean or English
            - If Korean, translate to English
            - If English, translate to Korean
            - Preserve meaning, tone, and nuance
            - Maintain proper grammar and formality level
            """},
        {"role": "user", "content": "Tell me a joke?"}
    ],
)

print(response)

# Convert the ChatCompletion object to a dictionary
response_dict = {
    'id': response.id,
    'choices': [
        {
            'message': {
                'role': choice.message.role,
                'content': choice.message.content
            },
            'index': choice.index,
            'finish_reason': choice.finish_reason
        }
        for choice in response.choices
    ],
    'model': response.model,
    'created': response.created,
    'usage': {
        'prompt_tokens': response.usage.prompt_tokens,
        'completion_tokens': response.usage.completion_tokens,
        'total_tokens': response.usage.total_tokens
    },
    'object': response.object,
    'cost': response.cost,
    'response': {
        'role': response.choices[0].message.role,
        'content': response.choices[0].message.content
    }
}

# Store response
url = f'{API_URL}/org/{ORG_ID}/routers/{router_id}/versions/{version_id}/response'

data = {
    'request': request,
    'response': response_dict
}

response = requests.post(url, headers=HEADERS, json=data)
print(response.json())
```

## Best Practices
1. Provide feedback regularly to improve routing decisions
2. Include detailed rationale for low scores
3. Store important translations for future analysis
4. Use consistent scoring criteria

## Common Issues
<AccordionGroup>
  <Accordion title="Invalid Score Range">
    Ensure scores are between 0 and 1
  </Accordion>
  <Accordion title="Missing Rationale">
    Always include explanatory rationale, especially for non-perfect scores
  </Accordion>
  <Accordion title="Request Format">
    Verify message format matches OpenAI chat completion format
  </Accordion>
</AccordionGroup>

## Next Steps
After implementing feedback:
1. Monitor router performance
2. Review feedback patterns
3. Track quality improvements
4. Analyze stored translations

<Note>
Remember to save response IDs for future reference. These can be useful for tracking improvements and analyzing patterns.
</Note>